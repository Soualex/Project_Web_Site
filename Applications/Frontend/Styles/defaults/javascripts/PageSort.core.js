var TotalElements=0;var TotalPages=1;var CurrentPage=1;var PageSortError=false;var PrevAjaxLoad="";$.fn.PageSort=function(o){this.each(function(i){var e=this;o=$.extend({ElementsPerPage:10,TotalElements:null,OrderColumn:null,OrderMethod:"DESC",Columns:{},ExtraPostData:{},PagesTableContainer:null,PagesTableNum:3,PagesTableStyle:"3ColWide",CallBeforeLoad:function(){},CallAfterLoad:function(a){},CallOnLoadError:function(a,b,c){},CallOnError:function(a,b,c){},JSONFile:null},o||{});if(o.TotalElements!=null){SetElementVariables(o.TotalElements)}function LoadJSONData(d){$(o.PagesTableContainer).hide();o.CallBeforeLoad();PrevAjaxLoad=$.ajax({url:o.JSONFile,dataType:"json",data:{data:"JSONData",ordercolumn:o.OrderColumn,ordermethod:o.OrderMethod,limitstart:GetLimitStart(),limitrows:o.ElementsPerPage},type:"POST",success:function(a){SetElementVariables(a.TotalElements);o.CallAfterLoad(a,TotalElements,TotalPages);d()},error:function(a,b,c){o.CallOnLoadError(a,b,c);o.CallOnError(a,b,c);PageSortError=true}})}function SetElementVariables(a){TotalElements=parseInt(a);TotalPages=Math.ceil(TotalElements/o.ElementsPerPage);if(CurrentPage>TotalPages&&TotalPages!=0){CurrentPage=TotalPages}}function GetLimitStart(){start=(o.ElementsPerPage*(CurrentPage-1));return start}function WritePagesTable(){if(o.PagesTableContainer==null){return}switch(o.PagesTableStyle){case"3ColWide":break;default:o.PagesTableStyle="3ColWide";break}if(o.PagesTableStyle=="3ColWide"){pagetablehtml='<div class="news_pagination"><ul>';if(CurrentPage>1){pagetablehtml+='<li><a class="switchpage prev" href="#?Page='+(CurrentPage-1)+'">1</a></li>'}if(CurrentPage>(o.PagesTableNum+1)){pagetablehtml+='<li><a class="switchpage page" href="#?Page=1">1</a></li><li><a class="page">...</a></li>'}pi=o.PagesTableNum;while(pi>=0){if((CurrentPage-pi)<1){pi--;continue}if((CurrentPage-pi)>=CurrentPage){break}pagetablehtml+='<li><a class="switchpage page" href="#?Page='+(CurrentPage-pi)+'">'+(CurrentPage-pi)+'</a></li>';pi--}pagetablehtml+='<li><a class="page active">'+CurrentPage+'</li>';fi=1;while(fi<=o.PagesTableNum){if((fi+CurrentPage)>TotalPages){break}pagetablehtml+='<li><a class="switchpage page" href="#?Page='+(CurrentPage+fi)+'">'+(CurrentPage+fi)+'</a></li>';fi++}if((CurrentPage+fi)<=TotalPages){pagetablehtml+='<li><a class="page">...</a></li><li><a class="switchpage page" href="#?Page='+TotalPages+'">'+TotalPages+'</a></li>'}if(CurrentPage<TotalPages){pagetablehtml+='<li><a class="switchpage next" href="#?Page='+(CurrentPage+1)+'">1</a></li>'}pagetablehtml+='</ul></div>';}$(o.PagesTableContainer).html(pagetablehtml).stop(true,true).fadeIn(500,"easeOutQuad");delete pagetablehtml}function BindPageSwitch(){$("a.switchpage").click(function(){var a=$(this).attr('href');var b=a.match(/#?Page=([0-9]+)/i);if(b!=null){CurrentPage=parseInt(b[1])}else{CurrentPage=1}if(typeof(PrevAjaxLoad.abort)=="function"){PrevAjaxLoad.abort()}Load()})}function Load(){if(typeof(CurrentPage)!="number"){CurrentPage=1}if(CurrentPage<1){CurrentPage=1}LoadJSONData(function(){if(!PageSortError){WritePagesTable();BindPageSwitch()}})}if(o.JSONFile==null){return false}WritePagesTable();BindPageSwitch()})};